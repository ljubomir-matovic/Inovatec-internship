<p-toast key="edit-profile" position="bottom-right"></p-toast>
<form [formGroup]="changePasswordForm" class="card d-flex justify-content-center align-items-stretch mx-auto mt-5 p-4" (submit)="submitForm()">
  <h2 class="text-center">{{ 'Common.ChangePassword' | translate }}</h2>
  <div class="w-100 d-flex flex-column gap-1">
    <label for="password">{{ 'Common.OldPassword' | translate }}</label>
    <p-password [style]="{ 'width':'100%' }" [inputStyle]="{ 'width':'100%' }" formControlName="oldPassword" [feedback]="false" [toggleMask]="true" id="oldPassword" [class.is-invalid]="!oldPassword.valid && oldPassword.touched" [class.ng-dirty]="!oldPassword.valid && oldPassword.touched"></p-password>
    <div class="errors-container">
      <div [class.is-invalid]="oldPasswordIsInvalid"></div>
      <div class="invalid-feedback" *ngIf="oldPassword.errors != null">
        <div *ngIf="oldPassword.errors['required']">{{ 'Common.Required' | translate }}</div>
        <div *ngIf="oldPassword.errors['pattern'] != undefined">{{ 'Common.WrongFormat' | translate }} <i class="pi pi-info-circle" pTooltip="Read suggestions"></i></div>
      </div>
    </div>
  </div>
  <div class="w-100 d-flex flex-column gap-1">
    <label for="password">{{ 'Common.NewPassword' | translate }}</label>
    <p-password [style]="{ 'width':'100%' }" [inputStyle]="{ 'width':'100%' }" formControlName="newPassword" [toggleMask]="true" id="newPassword" [class.is-invalid]="!newPassword.valid && newPassword.touched" [class.ng-dirty]="!newPassword.valid && newPassword.touched">
      <ng-template pTemplate="footer">
          <p-divider></p-divider>
          <p class="mt-2">{{ 'Common.Suggestions' | translate }}</p>
          <ul class="pl-2 ml-2 mt-0" style="line-height: 1.5">
              <li>{{ 'Common.AtLeastLower' | translate }}</li>
              <li>{{ 'Common.AtLeastUpper' | translate }}</li>
              <li>{{ 'Common.AtLeastNumeric' | translate }}</li>
              <li>{{ 'Common.AtLeastSpecial' | translate }}</li>
              <li>Minimum 8 {{ 'Common.Characters' | translate }}</li>
          </ul>
      </ng-template>
    </p-password>
    <div class="errors-container">
      <div [class.is-invalid]="newPasswordIsInvalid"></div>
      <div class="invalid-feedback" *ngIf="newPassword.errors != null">
        <div *ngIf="newPassword.errors['required']">{{ 'Common.Required' | translate }}</div>
        <div *ngIf="newPassword.errors['pattern'] != undefined">{{ 'Common.WrongFormat' | translate }} <i class="pi pi-info-circle" pTooltip="Read suggestions"></i></div>
      </div>
    </div>
  </div>
  <div class="w-100 d-flex flex-column gap-1">
    <label for="confirmedPassword">{{ 'Common.ConfirmPassword' | translate}}</label>
    <p-password [style]="{ 'width':'100%' }" [inputStyle]="{ 'width':'100%' }" formControlName="confirmedPassword" [feedback]="false" [toggleMask]="true" id="confirmedPassword" [class.is-invalid]="confirmedPasswordIsInvalid" [class.ng-dirty]="confirmedPasswordIsInvalid" [class.was-validated]="confirmedPasswordIsInvalid"></p-password>
    <div class="errors-container" >
      <div [class.is-invalid]="confirmedPasswordIsInvalid"></div>
      <div class="invalid-feedback" *ngIf="confirmedPassword.errors != null">
        <span *ngIf="confirmedPassword.errors['required']">{{ 'Common.Required' | translate }}</span>
        <span *ngIf="confirmedPassword.errors['confirmedPassword']">{{ 'Common.PasswordNotConfirmed' | translate }}</span>
      </div>
    </div>
  </div>
  <div class="d-flex justify-content-end">
    <button pButton type="submit" [label]="'Common.SubmitLabel' | translate" [disabled]="!changePasswordForm.valid" [loading]="sending"></button>
  </div>
</form>
